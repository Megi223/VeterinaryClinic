@model IEnumerable<VeterinaryClinic.Web.ViewModels.Notifications.NotificationViewModel>
@{
    this.ViewData["Title"] = "My Notifications";
}

<br />
<h1 style="text-align:center"><b>@this.ViewData["Title"]</b></h1>
@if (Model.Count() == 0)
{
    <h3 style="text-align:center">No new notifications</h3>
}
else
{
    <div class="text-center">
        <h1 class="display-4">Welcome</h1>
        <p id="user"></p>
        <div id="articleList"></div>
    </div>
    <button id="button" class="btn btn-warning">Refresh</button>
    <hr />
    @foreach (var notification in Model)
    {
        <div class="alert alert-primary alert-dismissible" role="alert">
            <p>@notification.Content</p>
            <form asp-area="" asp-controller="Notifications" asp-action="Delete" asp-route-id="@notification.Id">
                <input type="submit" value="Remove" class="btn btn-danger float-right" />
                <div class="clearfix"></div>
            </form>
        </div>
        <br />
    }
}


@section Scripts{
    <script src="~/lib/signalr/dist/browser/signalr.min.js"></script>
    <script>
        var connection =
            new signalR.HubConnectionBuilder()
                .withUrl("/notifications")
                .build();

        connection.on("SendMessage", (articleHeading, articleContent) => {
            var heading = document.createElement("h3");
            heading.textContent = articleHeading;
            var p = document.createElement("p");
            p.innerText = articleContent;
            var div = document.createElement("div");
            div.appendChild(heading);
            div.appendChild(p);

            document.getElementById("articleList").appendChild(div);
        });
        $("#button").click(function () {
            console.log(1);
        });
        connection.start();
    </script>

}